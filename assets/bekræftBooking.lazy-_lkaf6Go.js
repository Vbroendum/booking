import{f as B,a as C,d as I,j as e,B as S,e as T,s as L,w as j,M as R,t as p,r as g,x as E,v as P,G as z}from"./index-gzG90q43.js";import{u as k}from"./useRouteContext-DxKBh9X0.js";import{H as M}from"./Header-YHsSDmNv.js";import{S as O}from"./Steps-Bq029_zR.js";import{T as s,C as _,I as D}from"./Image-DhXbnsA8.js";import{T as N}from"./Title-Ck3ui-Js.js";import"./CheckIcon-C_jZfPJH.js";var y={root:"m_6d731127"};const U={gap:"md",align:"stretch",justify:"flex-start"},A=T((t,{gap:l,align:i,justify:r})=>({root:{"--stack-gap":L(l),"--stack-align":i,"--stack-justify":r}})),m=B((t,l)=>{const i=C("Stack",U,t),{classNames:r,className:o,style:n,styles:d,unstyled:x,vars:a,align:c,justify:u,gap:h,variant:v,...w}=i,b=I({name:"Stack",props:i,classes:y,className:o,style:n,classNames:r,styles:d,unstyled:x,vars:a,varsResolver:A});return e.jsx(S,{ref:l,...b("root"),variant:v,...w})});m.classes=y;m.displayName="@mantine/core/Stack";const H="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20width='24'%20height='24'%20viewBox='0%200%2024%2024'%20fill='none'%20stroke='%23228BE6'%20stroke-width='2'%20stroke-linecap='round'%20stroke-linejoin='round'%20class='feather%20feather-calendar'%3e%3crect%20x='3'%20y='4'%20width='18'%20height='18'%20rx='2'%20ry='2'%3e%3c/rect%3e%3cline%20x1='16'%20y1='2'%20x2='16'%20y2='6'%3e%3c/line%3e%3cline%20x1='8'%20y1='2'%20x2='8'%20y2='6'%3e%3c/line%3e%3cline%20x1='3'%20y1='10'%20x2='21'%20y2='10'%3e%3c/line%3e%3c/svg%3e",W="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20width='24'%20height='24'%20viewBox='0%200%2024%2024'%20fill='none'%20stroke='%23228BE6'%20stroke-width='2'%20stroke-linecap='round'%20stroke-linejoin='round'%20class='feather%20feather-clock'%3e%3ccircle%20cx='12'%20cy='12'%20r='10'%3e%3c/circle%3e%3cpolyline%20points='12%206%2012%2012%2016%2014'%3e%3c/polyline%3e%3c/svg%3e",G="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20width='24'%20height='24'%20viewBox='0%200%2024%2024'%20fill='none'%20stroke='%23228BE6'%20stroke-width='2'%20stroke-linecap='round'%20stroke-linejoin='round'%20class='feather%20feather-home'%3e%3cpath%20d='M3%209l9-7%209%207v11a2%202%200%200%201-2%202H5a2%202%200%200%201-2-2z'%3e%3c/path%3e%3cpolyline%20points='9%2022%209%2012%2015%2012%2015%2022'%3e%3c/polyline%3e%3c/svg%3e",V="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20width='24'%20height='24'%20viewBox='0%200%2024%2024'%20fill='none'%20stroke='%23228BE6'%20stroke-width='2'%20stroke-linecap='round'%20stroke-linejoin='round'%20class='feather%20feather-user'%3e%3cpath%20d='M20%2021v-2a4%204%200%200%200-4-4H8a4%204%200%200%200-4%204v2'%3e%3c/path%3e%3ccircle%20cx='12'%20cy='7'%20r='4'%3e%3c/circle%3e%3c/svg%3e",F="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20width='24'%20height='24'%20viewBox='0%200%2024%2024'%20fill='none'%20stroke='%23228BE6'%20stroke-width='2'%20stroke-linecap='round'%20stroke-linejoin='round'%20class='feather%20feather-git-pull-request'%3e%3ccircle%20cx='18'%20cy='18'%20r='3'%3e%3c/circle%3e%3ccircle%20cx='6'%20cy='6'%20r='3'%3e%3c/circle%3e%3cpath%20d='M13%206h3a2%202%200%200%201%202%202v7'%3e%3c/path%3e%3cline%20x1='6'%20y1='9'%20x2='6'%20y2='21'%3e%3c/line%3e%3c/svg%3e";function q({lokale:t,opened:l,closeModal:i,onConfirm:r}){j();const o=k({to:"/bekræftBooking"});return console.log(o),e.jsxs(R,{opened:l,onClose:i,centered:!0,size:"55rem",radius:15,title:e.jsx(s,{style:{fontWeight:"600",position:"absolute",left:"40%",top:"30%"},children:"Bekræftelse af booket lokale"}),children:[e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"4rem"},children:[e.jsxs(m,{children:[e.jsx(s,{style:{marginTop:"50px",marginLeft:"20px"},children:"Vi kan nu bekræfte at dit ønskede lokale er reserveret og booket til dig, god fornøjelse!"}),e.jsx(s,{style:{marginLeft:"20px"},children:"På undersiden “Mine Bookinger er der muligt at se din booking af lokale."})]}),e.jsx("div",{style:{justifyContent:"flex-end"},children:e.jsxs(m,{children:[e.jsx(N,{style:{marginLeft:"106px",fontWeight:"500",fontSize:"24px"},children:"Detaljer:"}),e.jsxs(s,{children:[e.jsx("img",{src:H,alt:"Calendar",style:{width:"20px",marginLeft:"80px",marginRight:"8px"}}),e.jsx("strong",{children:"Dato:"})," ",o.dateInfo.selected.toString()]}),e.jsxs(s,{children:[e.jsx("img",{src:W,alt:"Calendar",style:{width:"20px",marginLeft:"80px",marginRight:"8px"}}),e.jsx("strong",{children:"Tidspunkt:"})," ",o.startTimeInfo.startTime," - ",o.endTimeInfo.endTime]}),e.jsxs(s,{children:[e.jsx("img",{src:G,alt:"Calendar",style:{width:"20px",marginLeft:"80px",marginRight:"8px"}}),e.jsx("strong",{children:"Lokale: "})," ",t||"ikke angivet"]}),e.jsxs(s,{children:[e.jsx("img",{src:V,alt:"Calendar",style:{width:"20px",marginLeft:"80px",marginRight:"8px"}}),e.jsx("strong",{children:o.numberOfPeopleInfo.numberOfPeople})]}),e.jsxs(s,{children:[e.jsx("img",{src:F,alt:"Calendar",style:{width:"20px",marginLeft:"80px",marginRight:"8px"}}),e.jsx("strong",{children:"Booket af:"})]})]})})]}),e.jsx(p,{style:{marginLeft:"20px",marginBottom:"20px"},onClick:r,children:"Bekræft Booking"})]})}const J={margin:"20px",display:"flex",flexDirection:"row",alignItems:"center",textAlign:"left",width:"100%",padding:"10px"},K={display:"flex",flexDirection:"column",padding:"0 40px",flex:"2"},Q={marginBottom:"20px",textAlign:"center"};function X(t){const[l,i]=g.useState(!1),r=()=>i(!0),o=()=>i(!1),n=k({to:"/bekræftBooking"});console.log(n);const d=()=>{console.log("Confirming booking..."),t.onConfirmBooking(),o()};return e.jsxs(e.Fragment,{children:[e.jsxs(_,{style:J,shadow:"sm",radius:"md",withBorder:!0,children:[e.jsx("div",{style:{flex:"1"},children:e.jsx(D,{src:t.imageSrc||"https://raw.githubusercontent.com/mantinedev/mantine/master/.demo/images/bg-8.png",height:300,fit:"cover",alt:t.altText||"Selected Room"})}),e.jsxs("div",{style:K,children:[e.jsx("div",{style:Q,children:e.jsx(s,{fw:600,size:"30px",children:t.title||"Valgt Lokale"})}),e.jsxs("div",{children:[e.jsxs(s,{size:"sm",c:"dimmed",mb:"sm",children:[e.jsx("b",{children:"Dato:"})," ",n.dateInfo.selected.toString()||"Ikke angivet"]}),e.jsxs(s,{size:"sm",c:"dimmed",mb:"sm",children:[e.jsx("b",{children:"Tidspunkt:"})," ",n.startTimeInfo.startTime||"Ikke angivet"," - ",n.endTimeInfo.endTime]}),e.jsxs(s,{size:"sm",c:"dimmed",mb:"sm",children:[e.jsx("b",{children:"Lokale:"})," ",t.lokale]}),e.jsxs(s,{size:"sm",c:"dimmed",mb:"lg",children:[e.jsx("b",{children:"Antal personer:"})," ",n.numberOfPeopleInfo.numberOfPeople||"Ikke angivet"]})]}),e.jsx("div",{children:e.jsx(p,{color:"blue",fullWidth:!0,radius:"md",onClick:r,children:t.buttonText||"Bekræft booking"})})]})]}),e.jsx(q,{opened:l,closeModal:o,onConfirm:d,lokale:t.lokale})]})}const f=E(),ie=P("/bekræftBooking")({component:Y});function Y(){const t=j(),[l,i]=g.useState(2),[r,o]=g.useState(null),n=k({from:"/bekræftBooking"});g.useEffect(()=>{const c=new URLSearchParams(window.location.search).get("lokalenr");console.log("Extracted lokalenr:",c),c?o(c):console.error("No lokalenr found in the URL")},[]);const d=async()=>{try{if(!f){console.error("Supabase client is not initialized");return}const{data:{user:a},error:c}=await f.auth.getUser();if(c){console.error("Error getting user:",c.message);return}if(!a){console.error("No user is logged in");return}console.log("User ID:",a.id);const{data:u,error:h}=await f.from("bookings").insert([{start_time:n.startTimeInfo.startTime,end_time:n.endTimeInfo.endTime,number_of_people:n.numberOfPeopleInfo.numberOfPeople,lokale:r,start_date:n.dateInfo.selected,user_id:a.id}]);h?console.error("Error inserting booking:",h.message):(console.log("Booking successful:",u),t.navigate({to:"/mineBookinger"}))}catch(a){console.error("Unexpected error while booking:",a.message)}},x=()=>{console.log("Confirm booking clicked"),d()};return e.jsxs("div",{children:[e.jsx(M,{}),e.jsx("div",{style:{marginTop:"24px",marginBottom:"24px",display:"flex",justifyContent:"center"},children:e.jsxs(z,{position:"apart",style:{width:"100%"},children:[e.jsx(p,{variant:"light",onClick:()=>t.navigate({to:"/frontpage"}),style:{margin:"0 16px"},children:"Tilbage"}),e.jsx("div",{style:{display:"flex",justifyContent:"center",width:"90%"},children:e.jsx(O,{activeStep:l,setActiveStep:i})})]})}),e.jsx("div",{style:{display:"flex",justifyContent:"center",width:"100%",margin:"0 auto"},children:e.jsx("div",{style:{width:"50",maxWidth:"90%"},children:e.jsx(X,{buttonText:"Bekræft booking",color:"blue",date:n.setDateInfo,lokale:r,time:n.setStartTimeInfo,people:n.setNumberOfPeopleInfo,onConfirmBooking:x})})})]})}export{ie as Route,Y as default};
