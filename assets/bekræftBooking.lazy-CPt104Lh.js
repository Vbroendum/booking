import{r as l,j as e,t as f,x as p,v as b,w as j,G as y}from"./index-DxVA3fkW.js";import{u as g}from"./useRouteContext-CLI4BEZQ.js";import{H as v}from"./Header-Bb4685No.js";import{S as C}from"./Steps-CETa4-cT.js";import{C as S,I as w,T as s}from"./Image-BzP23T-w.js";import"./CheckIcon-Cgqh9s-r.js";const B={margin:"20px",display:"flex",flexDirection:"row",alignItems:"center",textAlign:"left",width:"100%",padding:"10px"},I={display:"flex",flexDirection:"column",padding:"0 40px",flex:"2"},T={marginBottom:"20px",textAlign:"center"};function R(t,d){l.useState(!1),l.useState(!1);const o=g({to:"/bekræftBooking"});console.log(o);const a=()=>{console.log("Confirming booking..."),t.onConfirmBooking()};return e.jsx(e.Fragment,{children:e.jsxs(S,{style:B,shadow:"sm",radius:"md",withBorder:!0,children:[e.jsx("div",{style:{flex:"1"},children:e.jsx(w,{src:t.imageSrc||"https://raw.githubusercontent.com/mantinedev/mantine/master/.demo/images/bg-8.png",height:300,fit:"cover",alt:t.altText||"Selected Room"})}),e.jsxs("div",{style:I,children:[e.jsx("div",{style:T,children:e.jsx(s,{fw:600,size:"30px",children:t.title||"Valgt Lokale"})}),e.jsxs("div",{children:[e.jsxs(s,{size:"sm",c:"dimmed",mb:"sm",children:[e.jsx("b",{children:"Dato:"})," ",o.dateInfo.selected.toString()||"Ikke angivet"]}),e.jsxs(s,{size:"sm",c:"dimmed",mb:"sm",children:[e.jsx("b",{children:"Tidspunkt:"})," ",o.startTimeInfo.startTime||"Ikke angivet"," - ",o.endTimeInfo.endTime]}),e.jsxs(s,{size:"sm",c:"dimmed",mb:"sm",children:[e.jsx("b",{children:"Lokale:"})," ",t.lokale]}),e.jsxs(s,{size:"sm",c:"dimmed",mb:"lg",children:[e.jsx("b",{children:"Antal personer:"})," ",o.numberOfPeopleInfo.numberOfPeople||"Ikke angivet"]})]}),e.jsx("div",{children:e.jsx(f,{color:"blue",fullWidth:!0,radius:"md",onClick:a,children:t.buttonText||"Bekræft booking"})})]})]})})}const c=p(),_=b("/bekræftBooking")({component:z});function z(){const t=j(),[d,o]=l.useState(2),[a,x]=l.useState(null),n=g({from:"/bekræftBooking"});l.useEffect(()=>{const r=new URLSearchParams(window.location.search).get("lokalenr");console.log("Extracted lokalenr:",r),r?x(r):console.error("No lokalenr found in the URL")},[]);const u=async()=>{try{if(!c){console.error("Supabase client is not initialized");return}const{data:{user:i},error:r}=await c.auth.getUser();if(r){console.error("Error getting user:",r.message);return}if(!i){console.error("No user is logged in");return}console.log("User ID:",i.id);const{data:k,error:m}=await c.from("bookings").insert([{start_time:n.startTimeInfo.startTime,end_time:n.endTimeInfo.endTime,number_of_people:n.numberOfPeopleInfo.numberOfPeople,lokale:a,user_id:i.id}]);m?console.error("Error inserting booking:",m.message):(console.log("Booking successful:",k),t.navigate({to:"/mineBookinger"}))}catch(i){console.error("Unexpected error while booking:",i.message)}},h=()=>{console.log("Confirm booking clicked"),u()};return e.jsxs("div",{children:[e.jsx(v,{}),e.jsx("div",{style:{marginTop:"24px",marginBottom:"24px",display:"flex",justifyContent:"center"},children:e.jsxs(y,{position:"apart",style:{width:"100%"},children:[e.jsx(f,{variant:"light",onClick:()=>t.navigate({to:"/frontpage"}),style:{margin:"0 16px"},children:"Tilbage"}),e.jsx("div",{style:{display:"flex",justifyContent:"center",width:"90%"},children:e.jsx(C,{activeStep:d,setActiveStep:o})})]})}),e.jsx("div",{style:{display:"flex",justifyContent:"center",width:"100%",margin:"0 auto"},children:e.jsx("div",{style:{width:"50",maxWidth:"90%"},children:e.jsx(R,{buttonText:"Bekræft booking",color:"blue",date:n.setDateInfo,lokale:a,time:n.setStartTimeInfo,people:n.setNumberOfPeopleInfo,onConfirmBooking:h})})})]})}export{_ as Route,z as default};
